resource "azurerm_resource_group_template_deployment" "malware_scanning" {
  name                = "malware-scanning-deploy"
  resource_group_name = var.resource_group_name
  deployment_mode     = "Incremental"
  template_content    = file("${path.module}/templates/malware_scanning_configuration.json")

  parameters_content = jsonencode({
    "storage_account_name" = var.document_storage_account_id
    "subscription_id"      = data.azurerm_subscription.current.id
    "resource_group"       = var.resource_group_name
    "event_grid_topicName" = var.malware_scanning_topic_name
    "cap_gb_per_month"     = 5000
  })
}
